<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Tagging - Men√∫</title>
    <style>
        html, body {
            margin: 0;
            font-family: Arial, sans-serif;
            padding: 10px;
            background-color: #f5f5f5;
        }
        h3 {
            margin-top: 0;
            color: #333;
        }
        button {
            display: block;
            width: 100%;
            margin: 5px 0;
            padding: 10px 12px;
            cursor: pointer;
            border: 1px solid #ccc;
            background-color: #fff;
            font-size: 14px;
            transition: all 0.2s;
        }
        button:hover {
            background-color: #e8f4ff;
        }
        button.selected {
            background-color: #3399ff;
            color: white;
            border-color: #007acc;
            font-weight: bold;
        }
        hr {
            border: none;
            border-top: 1px solid #ddd;
            margin: 15px 0;
        }
    </style>
</head>
<body>

<h3>üè∑Ô∏è TAGGING</h3>

<button type="button" id="btnStart"   onclick="runTagging(event, 'start', this)">üöÄ TAGGING START</button>
<button type="button" id="btnStop"    onclick="runTagging(event, 'stop', this)">üõë TAGGING STOP</button>
<button type="button" id="btnRestart" onclick="runTagging(event, 'restart', this)">üîÑ TAGGING RESTART</button>
<button type="button" id="btnStatus"  onclick="runTagging(event, 'status', this)">üìä TAGGING STATUS</button>

<hr>

<h4>Configuraci√≥n</h4>

<button type="button" id="btnConfig"  onclick="runTagging(event, 'config', this)">‚öôÔ∏è TAGGING CONFIG</button>

<hr>

<button type="button" id="btnInfo"    onclick="openInfo(event, this)">‚ÑπÔ∏è VER INFO</button>

<script>
function runTagging(event, action, btn) {
    // üîí Evitar que el bot√≥n navegue el iframe izquierdo
    event.preventDefault();
    event.stopPropagation();

    const iframe = parent.frames['body'];
    if (!iframe) {
        console.error("Iframe 'body' no encontrado");
        return;
    }

    // Marcar bot√≥n seleccionado
    const botones = document.querySelectorAll("button");
    botones.forEach(b => b.classList.remove("selected"));
    btn.classList.add("selected");

    sessionStorage.setItem("taggingSelected", btn.id);

    // Acci√≥n CONFIG ‚Üí cargar config.html en iframe derecho
    if (action === "config") {
        iframe.location.href = "/web/tagging/config.html";
        return;
    }

    // Otras acciones ‚Üí mostrar logs.html
    iframe.location.href = "/web/tagging/logs.html";

    // Ejecutar acci√≥n backend
    fetch('/admin/tagging', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ action })
    }).catch(error => {
        console.error("Error al ejecutar la acci√≥n:", error);
    });
}

// Restaurar bot√≥n seleccionado
window.addEventListener("DOMContentLoaded", () => {
    const saved = sessionStorage.getItem("taggingSelected");
    if (saved) {
        const btn = document.getElementById(saved);
        if (btn) btn.classList.add("selected");
    }
});

function openInfo(event, btn) {
    event.preventDefault();
    event.stopPropagation();

    const iframe = parent.frames['body'];
    if (!iframe) return;

    document.querySelectorAll("button").forEach(b => b.classList.remove("selected"));
    btn.classList.add("selected");
    sessionStorage.setItem("taggingSelected", btn.id);

    iframe.location.href = "/web/tagging/info.html";
}
</script>

</body>
</html>