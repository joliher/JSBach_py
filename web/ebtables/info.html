<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>EBTABLES - Informaci√≥n</title>
    <style>
        html, body {
            margin: 0;
            font-family: Arial, sans-serif;
            padding: 15px;
            background-color: #f5f5f5;
        }
        h3 {
            margin-top: 0;
            color: #333;
        }
        h4 {
            color: #007acc;
            margin-top: 20px;
            margin-bottom: 10px;
        }
        p, li {
            line-height: 1.6;
            color: #444;
        }
        .info-section {
            background: white;
            border-radius: 6px;
            padding: 15px;
            margin-bottom: 15px;
            border-left: 4px solid #007acc;
        }
        .highlight {
            background: #fff3cd;
            padding: 2px 6px;
            border-radius: 3px;
            font-weight: 600;
        }
        .warning-box {
            background: #fff3cd;
            border: 2px solid #ffc107;
            border-radius: 6px;
            padding: 12px;
            margin: 15px 0;
            color: #856404;
        }
        .info-box {
            background: #d1ecf1;
            border: 2px solid #0c5460;
            border-radius: 6px;
            padding: 12px;
            margin: 15px 0;
            color: #0c5460;
        }
        ul {
            margin-left: 20px;
        }
        code {
            background: #2d2d2d;
            color: #f8f8f2;
            padding: 2px 6px;
            border-radius: 3px;
            font-family: 'Courier New', monospace;
            font-size: 13px;
        }
        .code-block {
            background: #2d2d2d;
            color: #f8f8f2;
            padding: 12px;
            border-radius: 6px;
            font-family: 'Courier New', monospace;
            font-size: 13px;
            overflow-x: auto;
            margin: 10px 0;
        }
    </style>
</head>
<body>

<h3>üìñ Informaci√≥n del M√≥dulo EBTABLES</h3>

<div class="info-section">
    <h4>üåâ ¬øQu√© es EBTABLES?</h4>
    <p>
        El m√≥dulo <span class="highlight">EBTABLES</span> proporciona aislamiento de VLANs a nivel de 
        <strong>capa 2 (enlace de datos)</strong> utilizando <code>ebtables</code> 
        (Ethernet Bridge Tables). Esto permite controlar el tr√°fico entre VLANs de manera m√°s granular 
        que con iptables, actuando directamente sobre las tramas Ethernet.
    </p>
    
    <div class="info-box">
        <strong>‚ÑπÔ∏è Diferencia con Firewall:</strong><br>
        ‚Ä¢ <strong>Firewall (iptables):</strong> Opera en capa 3 (red) - IP<br>
        ‚Ä¢ <strong>Ebtables:</strong> Opera en capa 2 (enlace) - Ethernet
    </div>
</div>

<div class="info-section">
    <h4>üîß Funcionalidades</h4>
    <ul>
        <li><strong>üîí Aislamiento por VLAN:</strong> Permite aislar cada VLAN de forma independiente</li>
        <li><strong>üìä Control Granular:</strong> Cada VLAN tiene su propia cadena (VLAN_X_EBTABLES)</li>
        <li><strong>üîÑ Gesti√≥n Din√°mica:</strong> Aislar/desaislar VLANs en caliente</li>
        <li><strong>ÔøΩÔøΩ Dependencia WAN:</strong> Verifica que WAN est√© activa antes de operar</li>
    </ul>
</div>

<div class="info-section">
    <h4>‚öôÔ∏è Arquitectura T√©cnica (Optimizada - Redirecci√≥n por Interfaz)</h4>
    <p>El m√≥dulo implementa una arquitectura optimizada que redirecciona tr√°fico por interfaz VLAN en FORWARD:</p>
    
    <div class="code-block">Lectura:
vlans.json ‚Üí VLANs v√°lidas [1, 10, 20, 30]
tagging.json ‚Üí Interfaces ‚Üí [enxc84d44206f87, enxc84d4426b4ab, ...]

Construcci√≥n:
VLAN 3 ‚Üí Interfaces [enxc84d44206f87]

Reglas en FORWARD:
ebtables -A FORWARD -i enxc84d44206f87 -j FORWARD_VLAN_3   (redirecciona VLAN 3)
ebtables -A FORWARD -i enxc84d4426b4ab -j FORWARD_VLAN_1   (redirecciona VLAN 1)
ebtables -A FORWARD -j DROP                                 (rechaza resto)

Reglas en FORWARD_VLAN_3 (cuando est√° AISLADA):
ebtables -A FORWARD_VLAN_3 -i eth0 -j ACCEPT               (permite WAN entrada)
ebtables -A FORWARD_VLAN_3 -o eth0 -j ACCEPT               (permite WAN salida)
(DROP impl√≠cito por default)</div>

    <p style="margin-top: 15px;"><strong>Validaci√≥n de Sincronizaci√≥n:</strong></p>
    <ul style="margin: 8px 0 0 20px;">
        <li>‚úÖ VLANs en tagging.json DEBEN existir en vlans.json</li>
        <li>‚úÖ Si una VLAN en tagging NO existe ‚Üí se registra warning y se ignora</li>
        <li>‚úÖ El mapa solo incluye VLANs v√°lidas configuradas</li>
    </ul>

    <p style="margin-top: 15px;"><strong>Flujo de Tr√°fico (VLAN 3 AISLADA):</strong></p>
    <div class="info-box">
        <strong>Frame entra por enxc84d44206f87:</strong><br>
        1. Evaluaci√≥n en FORWARD: -i enxc84d44206f87 -j FORWARD_VLAN_3 ‚úì COINCIDE<br>
        2. Redirecciona a FORWARD_VLAN_3<br>
        3. Eval√∫a: -i eth0 -j ACCEPT / -o eth0 -j ACCEPT<br>
        4. Si coincide ‚Üí ‚úÖ PERMITIDO<br>
        5. Si no coincide ‚Üí ‚ùå BLOQUEADO (DROP impl√≠cito)<br>
        <br>
        <strong>Frame entra por otra interfaz:</strong><br>
        1. Evaluaci√≥n en FORWARD: -i enxc84d4426b4ab -j FORWARD_VLAN_1 ‚úó NO coincide<br>
        2. Evaluaci√≥n en FORWARD: -j DROP ‚úì COINCIDE<br>
        3. ‚ùå BLOQUEADO
    </div>

    <p style="margin-top: 15px;"><strong>Ventajas de esta Arquitectura:</strong></p>
    <ul style="margin: 8px 0 0 20px;">
        <li>üöÄ <strong>Eficiente:</strong> Primero filtra por interfaz en FORWARD, luego reglas espec√≠ficas</li>
        <li>üéØ <strong>Din√°mico:</strong> Se adapta autom√°ticamente a cambios en tagging.json</li>
        <li>‚úÖ <strong>Sincronizado:</strong> Valida que todas las VLANs existan</li>
        <li>üìä <strong>Escalable:</strong> Maneja m√∫ltiples interfaces por VLAN</li>
        <li>üîí <strong>Seguro:</strong> DROP final en FORWARD rechaza interfaz desconocidas</li>
        <li>üß© <strong>Modular:</strong> Cada VLAN es independiente</li>
    </ul>
</div>

<div class="info-section">
    <h4>üìã Requisitos</h4>
    <ul>
        <li>‚úÖ El m√≥dulo <span class="highlight">WAN</span> debe estar activo</li>
        <li>‚úÖ El m√≥dulo <span class="highlight">VLANs</span> debe tener VLANs configuradas</li>
        <li>‚úÖ El paquete <code>ebtables</code> instalado en el sistema</li>
        <li>‚úÖ Permisos sudo configurados en <code>/etc/sudoers.d/jsbach</code></li>
    </ul>
    
    <div class="warning-box">
        <strong>‚ö†Ô∏è Advertencia:</strong> El aislamiento de VLANs puede interrumpir la comunicaci√≥n 
        entre dispositivos. Aseg√∫rate de comprender las implicaciones antes de aislar VLANs en producci√≥n.
    </div>
</div>

<div class="info-section">
    <h4>üöÄ Uso B√°sico</h4>
    <ol>
        <li><strong>Iniciar el m√≥dulo:</strong> Click en "EBTABLES START"</li>
        <li><strong>Aislar VLAN:</strong> Ir a "CONFIGURAR AISLAMIENTO" ‚Üí Aislar</li>
        <li><strong>Desaislar VLAN:</strong> Usar bot√≥n "Desaislar"</li>
        <li><strong>Ver estado:</strong> Click en "EBTABLES STATUS"</li>
    </ol>
</div>

<div class="info-section">
    <h4>üìö Casos de Uso</h4>
    <ul>
        <li><strong>Seguridad IoT:</strong> Aislar dispositivos IoT para que solo accedan a Internet</li>
        <li><strong>Guest Networks:</strong> Aislar redes de invitados</li>
        <li><strong>Segmentaci√≥n:</strong> Separar departamentos o funciones</li>
        <li><strong>Testing:</strong> Aislar segmentos para pruebas</li>
        <li><strong>Compliance:</strong> Cumplir requisitos (PCI-DSS, HIPAA)</li>
    </ul>
</div>

<div class="info-box">
    <strong>üí° Nota:</strong> Por defecto, todas las VLANs est√°n <strong>NO AISLADAS</strong>. 
    Debes aislarlas expl√≠citamente seg√∫n necesidad.
</div>

</body>
</html>
